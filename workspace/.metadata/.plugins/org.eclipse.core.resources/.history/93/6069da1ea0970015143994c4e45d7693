/**
 * PMP2, WS 2015/16
 * Gruppe: Jannes Volkens (jannes.volkens@haw-hamburg.de),
 * Leon Schlichting (leon.schlichting@haw-hamburg.de)
 * Aufgabe: Aufgabenblatt 3, Aufgabe 3
 */

package aufgabenblatt3;

import java.util.Observable;

/**
 * Klasse Simulation extends Observable implements Runnable simuliert zwei
 * Lokführer die ein und ausfahren auf zufällige Gleise im Bereich 0-2
 * 
 * @author Leon
 *
 */
public class Simu extends Observable implements Runnable {
  
  /**
   * Rangierbahnhof bahnhof
   */
  protected RangierBf bahnhof = new RangierBf();

  /**
   * Konstruktor
   * 
   * @param bahnhof
   */
  public Simu(RangierBf bahnhof) {
	this.bahnhof = bahnhof;
  }

  /**
   * Getter
   * 
   * @return
   */
  public RangierBf getBahnhof() {
	return bahnhof;
  }

  /**
   * @Override run Methode erstellt zwei Lokführer die ein und ausfahren, ihr
   *           Zielgleis wird alle x-millis neu festgelegt.
   */
  @Override
  public void run() {
	LokFr lokf;
	while (!Thread.currentThread().isInterrupted()) {

	  int gleis = (int) (10 * Math.random());
	  int gleis2 = (int) (10 * Math.random());
	  boolean wahr = Math.random() < 0.5;

	  //Thread.sleep(500);
	  if (wahr) {
	    lokf = new LokFr(new Einfahren(bahnhof, new Zug(), gleis));
	    lokf.start();
	  } else {
	    lokf = new LokFr(new Ausfahren(bahnhof, gleis2));
	    lokf.start();
	  }
	  setChanged();
	  notifyObservers();
	  System.err.println("   " + gleis + "   " + gleis2 +"   " +  wahr);
	}
  }
}
